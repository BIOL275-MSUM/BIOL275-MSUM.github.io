<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3 Introduction to ggplot2 | Quantitative Biology BIOL 275 at MSUM</title>
<meta name="author" content="Chris Merkord">
<meta name="description" content="3.1 Objectives In this lab, you will learn to: Use the layered grammar of graphics: Create a blank graph using the ggplot() function Add geometric objects to a graph Define an aesthetic mapping...">
<meta name="generator" content="bookdown 0.24.4 with bs4_book()">
<meta property="og:title" content="3 Introduction to ggplot2 | Quantitative Biology BIOL 275 at MSUM">
<meta property="og:type" content="book">
<meta property="og:description" content="3.1 Objectives In this lab, you will learn to: Use the layered grammar of graphics: Create a blank graph using the ggplot() function Add geometric objects to a graph Define an aesthetic mapping...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="3 Introduction to ggplot2 | Quantitative Biology BIOL 275 at MSUM">
<meta name="twitter:description" content="3.1 Objectives In this lab, you will learn to: Use the layered grammar of graphics: Create a blank graph using the ggplot() function Add geometric objects to a graph Define an aesthetic mapping...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1.9000/transition.js"></script><script src="libs/bs3compat-0.3.1.9000/tabs.js"></script><script src="libs/bs3compat-0.3.1.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.20/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><!-- <link rel="stylesheet" href="https://use.typekit.net/nvk0gxc.css"> --><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="styles.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Quantitative Biology BIOL 275 at MSUM</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li class="book-part">Lab Assignments</li>
<li><a class="" href="hello-world.html"><span class="header-section-number">1</span> Hello World!</a></li>
<li><a class="" href="introduction-to-rstudio.html"><span class="header-section-number">2</span> Introduction to RStudio</a></li>
<li><a class="active" href="introduction-to-ggplot2.html"><span class="header-section-number">3</span> Introduction to ggplot2</a></li>
<li><a class="" href="data-subsetting.html"><span class="header-section-number">4</span> Data subsetting</a></li>
<li><a class="" href="data-summarizing.html"><span class="header-section-number">5</span> Data summarizing</a></li>
<li><a class="" href="comparing-means.html"><span class="header-section-number">6</span> Comparing means</a></li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">7</span> Linear regression</a></li>
<li class="book-part">EDA Project</li>
<li><a class="" href="eda-project.html"><span class="header-section-number">8</span> EDA Project</a></li>
<li><a class="" href="sac-application.html"><span class="header-section-number">9</span> SAC Application</a></li>
<li><a class="" href="sac-poster.html"><span class="header-section-number">10</span> SAC Poster</a></li>
<li><a class="" href="data-sets-1.html"><span class="header-section-number">11</span> Data sets</a></li>
<li><a class="" href="public-health-data-sets-1.html"><span class="header-section-number">12</span> Public health data sets</a></li>
<li><a class="" href="ebird-data-sets.html"><span class="header-section-number">13</span> eBird data sets</a></li>
<li class="book-part">Appendices</li>
<li class="book-part">Getting Started</li>
<li><a class="" href="install-r-and-rstudio.html"><span class="header-section-number">16</span> Install R and RStudio</a></li>
<li><a class="" href="install-git.html"><span class="header-section-number">17</span> Install Git</a></li>
<li class="book-part">Using RStudio</li>
<li><a class="" href="project-options.html"><span class="header-section-number">19</span> Project Options</a></li>
<li><a class="" href="code-sections.html"><span class="header-section-number">20</span> Code Sections</a></li>
<li><a class="" href="r-markdown-documents.html"><span class="header-section-number">21</span> R Markdown documents</a></li>
<li><a class="" href="session-info.html"><span class="header-section-number">22</span> Session info</a></li>
<li class="book-part">Git and GitHub</li>
<li><a class="" href="about-git-and-github.html"><span class="header-section-number">24</span> About Git and GitHub</a></li>
<li><a class="" href="github-notifications.html"><span class="header-section-number">25</span> GitHub Notifications</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/BIOL275-MSUM/BIOL275-MSUM.github.io">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="introduction-to-ggplot2" class="section level1">
<h1>
<span class="header-section-number">3</span> Introduction to ggplot2<a class="anchor" aria-label="anchor" href="#introduction-to-ggplot2"><i class="fas fa-link"></i></a>
</h1>
<div id="objectives-2" class="section level2">
<h2>
<span class="header-section-number">3.1</span> Objectives<a class="anchor" aria-label="anchor" href="#objectives-2"><i class="fas fa-link"></i></a>
</h2>
<p>In this lab, you will learn to:</p>
<ul>
<li>
<p>Use the layered grammar of graphics:</p>
<ul>
<li>Create a blank graph using the <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> function</li>
<li>Add geometric objects to a graph</li>
<li>Define an aesthetic mapping for a graph</li>
<li>Add labels to a graph</li>
<li>Fix some common styling</li>
</ul>
</li>
<li>
<p>Create a graph showing the distribution of a single variable</p>
<ul>
<li>Create a bar chart for a categorical variable using the <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> functions</li>
<li>Arrange the categories in a bar chart by frequency</li>
<li>Create a histogram for a numerical variable using the <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> function</li>
<li>Choose and set appropriate histogram bin widths</li>
</ul>
</li>
<li><p>Set the image width for an R Markdown code chunk</p></li>
</ul>
</div>
<div id="introduction" class="section level2">
<h2>
<span class="header-section-number">3.2</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction"><i class="fas fa-link"></i></a>
</h2>
<p>This lab will introduce you to visualizing data using ggplot2.</p>
<p>R has other systems for creating graphs, such as the plotting functions included with base R. At times you may end up searching online for help with you R code. Be sure to add ggplot to any of your search terms so that you end up finding solutions that fit within the requirements of this course.</p>
<p>The instructions below correspond to sections 1, 2, 3, and 6 in the <a href="https://r4ds.had.co.nz/data-visualisation.html" title="3 Data visualisation | R for Data Science">Data visualisation</a> chapter of your lab manual, <em>R for Data Science</em>. If the steps below do not make sense on their own, please read those sections.</p>
</div>
<div id="project-setup-1" class="section level2">
<h2>
<span class="header-section-number">3.3</span> Project Setup<a class="anchor" aria-label="anchor" href="#project-setup-1"><i class="fas fa-link"></i></a>
</h2>
<p>For this lab you will work in a new RStudio Project under git version control. Here are the steps you should follow to set up your Project:</p>
<ol style="list-style-type: decimal">
<li>
<p>Claim your repository</p>
<ol style="list-style-type: lower-alpha">
<li><p>Go to the course D2L page</p></li>
<li><p>Find the Content module for this lab</p></li>
<li>
<p>Follow the link to claim your repository (repo) on GitHub</p>
<p><em>Note: this link will not appear until the day of your lab. If you want to get ahead, you can always try reading the <a href="https://r4ds.had.co.nz/data-visualisation.html" title="3 Data visualisation | R for Data Science">Data visualisation</a> chapter ahead of time</em></p>
</li>
<li><p>Copy the URL for your newly created repository</p></li>
</ol>
</li>
<li>
<p>Create a new project</p>
<ol style="list-style-type: lower-alpha">
<li>Open RStudio</li>
<li>Click <strong>New Project…</strong> on the File menu or Project menu (upper right)</li>
<li>In the dialog window, select Version Control and then Git</li>
<li>Paste the URL for your repo</li>
<li>Hit tab to autofill the Directory name field. If it does not autofill, then type in the name of your repository as best you can (include the word “lab”, the lab number, and your name)</li>
<li>Click the Browse button and find a good place on your hard drive for this project to live</li>
<li>Set your Project options. When the project opens, go to Tools &gt; Project Options… and change the first three drop down menus to “No” (see <a href="project-options.html">Project Options</a> for detailed instructions and rationale)</li>
</ol>
</li>
<li><p>Open README.Rmd and edit it, replacing triple underscores “___” with your text.</p></li>
<li>
<p>Create a new script</p>
<ol style="list-style-type: lower-alpha">
<li><p>Click the New File button (upper left) or go to File &gt; New File</p></li>
<li><p>Select “R script”</p></li>
<li><p>Immediately save your script with a useful name, for example <code>tutorial-walk-through.R</code></p></li>
</ol>
</li>
</ol>
<p>For the rest of the lab, you will copying code from this website and paste it into your R script. <em>Only later, after you have a working R script, will you copy anything into your lab report R Markdown document.</em></p>
</div>
<div id="load-packages" class="section level2">
<h2>
<span class="header-section-number">3.4</span> Load packages<a class="anchor" aria-label="anchor" href="#load-packages"><i class="fas fa-link"></i></a>
</h2>
<p>ggplot2 is one of the core packages in the tidyverse. In the code below, you will load the ggplot2 package and other tidyverse packages. Before you do, get your script off to a nice start by adding a code section. Code sections keep your code organized and makes it easy to jump to specific code sections without scrolling. In a long script, this can be a real time saver. The <a href="code-sections.html">Code Sections</a> chapter has more details, but for now you can just follow these instructions:</p>
<ol style="list-style-type: decimal">
<li>Go to <strong>Code &gt; Insert Section…</strong> or use the keyboard shortcut Ctrl+Shift+I / Cmd+Shift+I</li>
<li>Type “load packages” in the dialog window and click the <strong>OK</strong> button</li>
</ol>
<p>As you work through the tutorials, add other code headings as necessary.</p>
<p>Load the tidyverse package by adding this code below the new code section and running it:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<p>That line of code <strong><em>loads</em></strong> the tidyverse package and the eight core packages within the tidyverse, one of which is ggplot2. The vast majority of your data science needs can be met with those eight packages. While it is possible to load each package individually, for example <code><a href="https://ggplot2.tidyverse.org">library(ggplot2)</a></code>, it’s usually better to load the tidyverse package because its not often that you only want to use one of the packages in the tidyverse.</p>
<p>When you run the code, you will see a <strong><em>message</em></strong> in the console like this:</p>
<pre><code>#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>#&gt; ✔ ggplot2 3.3.5     ✔ purrr   0.3.4
#&gt; ✔ tibble  3.1.6     ✔ dplyr   1.0.7
#&gt; ✔ tidyr   1.1.4     ✔ stringr 1.4.0
#&gt; ✔ readr   2.1.1     ✔ forcats 0.5.1</code></pre>
<pre><code>#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
#&gt; ✖ dplyr::filter() masks stats::filter()
#&gt; ✖ dplyr::lag()    masks stats::lag()</code></pre>
<p>The first part tells you which packages are being loaded. You will notice ggplot2 is on that list. The second part of the message tells you which tidyverse functions conflict with (and override) other functions. Usually those other functions are from base R, but they could also be functions from other packages you had already loaded. If you ever want to use a package that has been overridden with another package, you have to refer to it explicitly by its package <em>and</em> function name.</p>
</div>
<div id="bar-graphs" class="section level2">
<h2>
<span class="header-section-number">3.5</span> Bar graphs<a class="anchor" aria-label="anchor" href="#bar-graphs"><i class="fas fa-link"></i></a>
</h2>
<p>Bar graphs are used to show the distribution of a single <em>categorical</em> variable.</p>
<div id="example-tiger-data" class="section level3">
<h3>
<span class="header-section-number">3.5.1</span> Example: tiger data<a class="anchor" aria-label="anchor" href="#example-tiger-data"><i class="fas fa-link"></i></a>
</h3>
<p>We will use the data from Example 2.2A in your textbook for this activity. The summary from the textbook is as follows:</p>
<blockquote>
<p>Conflict between humans and tigers threatens tiger populations, kills people, and reduces public support for conservation. Gurung et al. (2008) investigated causes of human deaths by tigers near the protected area of Chitwan National Park, Nepal. Eighty-eight people were killed by 36 individual tigers between 1979 and 2006, mainly within 1 km of the park edge. Table 2.2-1 lists the main activities of people at the time they were killed. Such information may be helpful to identify activities that increase vulnerability to attack.</p>
</blockquote>
<p>The dataset consists of one table showing the activities of 88 people at the time they were attacked and killed by tigers near Chitwan National Park, Nepal, from 1979 to 2006.</p>
<p>You can view and explore the data using this interactive table:</p>
<div id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88],["Disturbing tiger kill","Forest products","Grass/fodder","Fuelwood/timber","Grass/fodder","Forest products","Grass/fodder","Fishing","Fuelwood/timber","Grass/fodder","Forest products","Forest products","Forest products","Grass/fodder","Forest products","Grass/fodder","Grass/fodder","Grass/fodder","Fuelwood/timber","Fishing","Grass/fodder","Grass/fodder","Grass/fodder","Fuelwood/timber","Grass/fodder","Herding","Grass/fodder","Herding","Grass/fodder","Fishing","Grass/fodder","Grass/fodder","Sleeping in house","Grass/fodder","Grass/fodder","Grass/fodder","Grass/fodder","Grass/fodder","Grass/fodder","Herding","Herding","Fishing","Grass/fodder","Forest products","Forest products","Grass/fodder","Grass/fodder","Forest products","Disturbing tiger kill","Walking","Fishing","Herding","Grass/fodder","Grass/fodder","Sleeping in house","Fishing","Fishing","Toilet","Grass/fodder","Walking","Grass/fodder","Grass/fodder","Grass/fodder","Grass/fodder","Grass/fodder","Grass/fodder","Grass/fodder","Fuelwood/timber","Grass/fodder","Disturbing tiger kill","Herding","Grass/fodder","Grass/fodder","Grass/fodder","Herding","Grass/fodder","Grass/fodder","Grass/fodder","Grass/fodder","Grass/fodder","Forest products","Toilet","Walking","Disturbing tiger kill","Disturbing tiger kill","Sleeping in house","Forest products","Fishing"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>person<\/th>\n      <th>activity<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":1},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Each row in the table represents a sample unit, or person. Thus the sample size is 88.</p>
<p>The variables are:</p>
<ul>
<li><p><strong>person</strong>. a number from 1 to 88 identifying which person the data pertains to. While this variable contains a number, it is incorrect to call it a numeric variable. The number was not measured, and it cannot have mathematical functions applied to it such as calculating the mean. The value is really no different than a person’s name, which would consist of text. Therefore it is best to consider person a <em>categorical</em> variable.</p></li>
<li><p><strong>activity</strong>. the person’s activity at the time they were attacked and killed. This is a <em>categorical</em> variable with a discrete number of possible values.</p></li>
</ul>
<p>For our purposes, the only variable of interest is activity. We will not use the person variable.</p>
</div>
<div id="read-the-tiger-data" class="section level3">
<h3>
<span class="header-section-number">3.5.2</span> Read the tiger data<a class="anchor" aria-label="anchor" href="#read-the-tiger-data"><i class="fas fa-link"></i></a>
</h3>
<p>The next step in your R script is to read the data into R.</p>
<p>First, create a new <a href="code-section.html">code section</a> named “deaths from tigers”</p>
<p>The data for this and other examples from your textbook can be found on the <a href="https://whitlockschluter.zoology.ubc.ca/">book website</a>. It is stored as a comma-separated values file (.csv).</p>
<p>Read the data from the textbook website using the <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> function, part of the readr package, and assign it to an object named <code>tiger_data</code> using the left assignment operator <code>&lt;-</code>. To do that, copy the code in here and paste it into your script. You do not need to follow the link in your web browser or download the data to your computer.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tiger_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://whitlockschluter.zoology.ubc.ca/wp-content/data/chapter02/chap02e2aDeathsFromTigers.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; Rows: 88 Columns: 2</code></pre>
<pre><code>#&gt; ── Column specification ────────────────────────────────────────────────────────
#&gt; Delimiter: ","
#&gt; chr (1): activity
#&gt; dbl (1): person</code></pre>
<pre><code>#&gt; 
#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.
#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>The message you get in your console tells you how the data in the CSV was parsed (interpretted) when it was read into R. You can ignore it for now.</p>
</div>
<div id="view-the-tiger-data" class="section level3">
<h3>
<span class="header-section-number">3.5.3</span> View the tiger data<a class="anchor" aria-label="anchor" href="#view-the-tiger-data"><i class="fas fa-link"></i></a>
</h3>
<p>You will notice that the data itself did not appear in the console. That’s because we assigned it to an object but did not print it. To print the data in the console, type the name of the object into your R script and run it. Alternatively, you can copy and paste the code in the code box below, but ONLY INCLUDE THE CODE BELOW, NOT THE OUTPUT LINES PRECEDED BY #&gt;</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tiger_data</span>                  <span class="co"># print the data in the console</span></code></pre></div>
<pre><code>#&gt; # A tibble: 88 × 2
#&gt;   person activity             
#&gt;    &lt;dbl&gt; &lt;chr&gt;                
#&gt; 1      1 Disturbing tiger kill
#&gt; 2      2 Forest products      
#&gt; 3      3 Grass/fodder         
#&gt; 4      4 Fuelwood/timber      
#&gt; 5      5 Grass/fodder         
#&gt; 6      6 Forest products      
#&gt; # … with 82 more rows</code></pre>
<p>The output in the console indicates the object is a tibble (a tidyverse name for a table of data) with 88 observations (rows) and 2 variables (columns).</p>
<p>You can view a list of distinct values taken by a categorical variable by using the <code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code> function, which returns a table of distinct values taken by the variable. The first argument to the function is the name of the data, the second argument is the name of the variable.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">tiger_data</span>, <span class="va">activity</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 9 × 1
#&gt;   activity             
#&gt;   &lt;chr&gt;                
#&gt; 1 Disturbing tiger kill
#&gt; 2 Forest products      
#&gt; 3 Grass/fodder         
#&gt; 4 Fuelwood/timber      
#&gt; 5 Fishing              
#&gt; 6 Herding              
#&gt; 7 Sleeping in house    
#&gt; 8 Walking              
#&gt; 9 Toilet</code></pre>
</div>
<div id="frequency-table" class="section level3">
<h3>
<span class="header-section-number">3.5.4</span> Frequency table<a class="anchor" aria-label="anchor" href="#frequency-table"><i class="fas fa-link"></i></a>
</h3>
<p>If you want to see how many times each value of activity occurs in the data, you can create a frequency table using the <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> function. Again, the data object is the first argument and the variable name is the second argument.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">tiger_data</span>, <span class="va">activity</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 9 × 2
#&gt;   activity                  n
#&gt;   &lt;chr&gt;                 &lt;int&gt;
#&gt; 1 Disturbing tiger kill     5
#&gt; 2 Fishing                   8
#&gt; 3 Forest products          11
#&gt; 4 Fuelwood/timber           5
#&gt; 5 Grass/fodder             44
#&gt; 6 Herding                   7
#&gt; # … with 3 more rows</code></pre>
<p>As you can see, this function returns another tibble that has two variables: the original one <em>activity</em> and a new one <em>n</em>, which represents the number of times the variable occurred in the data.</p>
</div>
<div id="make-a-bar-graph" class="section level3">
<h3>
<span class="header-section-number">3.5.5</span> Make a bar graph<a class="anchor" aria-label="anchor" href="#make-a-bar-graph"><i class="fas fa-link"></i></a>
</h3>
<p>The distribution of a single categorical variable is best visualized using bar graph (also called a bar chart, barchart, or column graph). In this section, you will learn how to create a bar graph.</p>
<p>ggplot uses a layered approach to building a graph. You will learn more about what this means as you build your first graph using the tiger data. Your goal is to create a bar graph similar to the one in the textbook in Figure 2.2-1, which looks like this:</p>
<div class="inline-figure"><img src="images/whitlock_2.2-1.jpg" class="text-center" width="400"></div>
<p>The first step is to create a new ggplot using the <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> function. The first (and for now, only) argument is the data argument. You should set it to the data object you created above. Now run the code:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tiger_data</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-3_files/figure-html/unnamed-chunk-6-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>When you plot something in RStudio (i.e. when you create a graph), it will appear in the Plots tab in the lower right pane.</p>
<p>Look at the Plots tab. What do you see? At first you may think it is a blank screen, but actually it is a gray box representing the empty plot. At this point, R knows you want to plot the tiger data, but it doesn’t know which variables to plot or how to display the data.</p>
<div id="geometric-objects-and-aesthetic-mappings" class="section level4">
<h4>
<span class="header-section-number">3.5.5.1</span> Geometric objects and aesthetic mappings<a class="anchor" aria-label="anchor" href="#geometric-objects-and-aesthetic-mappings"><i class="fas fa-link"></i></a>
</h4>
<p>To display the data, we need to add a geometric object. In this case, because we want a bar graph, we will use the <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> function. You add the geometric object to the canvas using a plus sign like this:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tiger_data</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">activity</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-3_files/figure-html/unnamed-chunk-7-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>The first (and for now, only) argument to <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> is <code>mapping</code>, an aesthetic mapping that tells R which variables in the data table <em>map</em> to which parts of the graph. An aesthetic mapping is defined by the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> function. <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> requires only one aesthetic, the argument <code>x</code>, which tells R which variable to put on the x axis.</p>
<p>How did we know what variable to put on the x-axis in the bar graph? That’s determined by the purpose to the graph. For this graph, the purpose is to plot the distribution of the activities of people attacked and killed by tigers. But what is the actual variable we want to graph? For that you need to go back and look at the data itself. Print the data in the console again by typing its name and running the line:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tiger_data</span></code></pre></div>
<p>The variables are listed on the second row the of the output. You can see they are named <em>person</em> and <em>activity</em>. Which one is the variable we want to graph? It is <em>activity</em>. So in your aesthetic mapping the code <code>x = activity</code> can be translated as “put the activity variable on the x axis”.</p>
<p>Any variables you map to an aesthetic must be present in the data, and the variable name must appear exactly as it does in the data.</p>
<p>Put this all together, and the way to add a bars to the graph is <code>geom_bar(mapping = aes(x = activity)</code></p>
</div>
<div id="labels-and-themes" class="section level4">
<h4>
<span class="header-section-number">3.5.5.2</span> Labels and themes<a class="anchor" aria-label="anchor" href="#labels-and-themes"><i class="fas fa-link"></i></a>
</h4>
<p>The result figure, shown above, should look similar to the one in Figure 2.2-1 of your textbook. With a couple of notable exceptions:</p>
<ol style="list-style-type: decimal">
<li><p>The columns should be ordered by height</p></li>
<li><p>The color should be red</p></li>
<li><p>The axis labels “count” and “activity” should be changed to something more informative</p></li>
<li>
<p>Various theme elements could be improved:</p>
<ol style="list-style-type: lower-roman">
<li>The font size should be larger</li>
<li>The axis labels should be bold</li>
<li>The axis tick labels (the activity names) should be rotated 45 degrees</li>
<li>The axis ticks should be removed</li>
</ol>
</li>
</ol>
<p>Let’s fix each of those issues in turn.</p>
<p>First, arrange the levels (categories) of activity in descending order by count (i.e. big columns on the left), using a bit of wizardry from the forcats package, one of the core packages in the tidyverse that was loaded when you loaded the tidyverse package. The <code><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq()</a></code> function changes a variable to factor with the levels defined by how frequently they occur in the data. Inside the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> function, change <code>x = activity</code> to <code>x = fct_infreq(activity)</code>.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tiger_data</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">activity</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-3_files/figure-html/unnamed-chunk-9-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Second, change color of the columns by adding a <code>fill</code> argument to <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>. Put a comma after the closing parenthesis of the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> function and add <code>fill =</code>. For the fill color, you could try <code>"red"</code> or <code>"darkred"</code>, but for an exact match use the hex color <code>"#C5351B"</code>.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tiger_data</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">activity</span><span class="op">)</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"#C5351B"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-3_files/figure-html/unnamed-chunk-10-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Third, add better x- and y-axis labels using the <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code> function. Axis labels should start with capital letters and, for numeric variables, should include the units of measurement in parentheses. The argument <code>x</code> sets the x-axis label while the argument <code>y</code> sets the y-axis label. The label text itself should appear in quotation marks. The <code>x</code> and <code>y</code> arguments should be separated by a comma.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tiger_data</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">activity</span><span class="op">)</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"#C5351B"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Activity"</span>, y <span class="op">=</span> <span class="st">"Frequency (number of people)"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-3_files/figure-html/unnamed-chunk-11-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Fourth, fix the look of the graph by using:</p>
<ul>
<li><p>the <code>width</code> argument of <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> to set make the bars (columns) a bit narrower</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous()</a></code> to set the y-axis limits to 0 and 50, with no buffer</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic()</a></code> to remove the background color, adds axis lines, and increases the base font size</p></li>
<li>
<p><code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme()</a></code> to change various other theme elements such as:</p>
<ul>
<li><p>Make the axis labels bold</p></li>
<li><p>Make the x- and y-axis text black and larger</p></li>
<li><p>Make the x-axis text angled and right justified</p></li>
<li><p>Remove the x-axis tick marks</p></li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tiger_data</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">activity</span><span class="op">)</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"#C5351B"</span>, 
           width <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Activity"</span>, y <span class="op">=</span> <span class="st">"Frequency (number of people)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,
    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">rel</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,
    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
    axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-3_files/figure-html/unnamed-chunk-12-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Compare your figure to the original above. Not bad! This one, however, can be inserted into any document at any size and resolution. And most importantly, your code documents how you created the graph, ensuring the figure could be reproduced by anyone.</p>
<p>Note that you could get pretty close with just the first three lines of code and perhaps the one theme element to rotate the axis text labels.</p>
</div>
</div>
</div>
<div id="histograms" class="section level2">
<h2>
<span class="header-section-number">3.6</span> Histograms<a class="anchor" aria-label="anchor" href="#histograms"><i class="fas fa-link"></i></a>
</h2>
<p>Histograms are used to show the distribution of a single numerical variable.</p>
<p>Now that you know the basics creating a ggplot, creating a histogram will require relatively little explanation.</p>
<div id="example-bird-data" class="section level3">
<h3>
<span class="header-section-number">3.6.1</span> Example: bird data<a class="anchor" aria-label="anchor" href="#example-bird-data"><i class="fas fa-link"></i></a>
</h3>
<p>We will use the data from Example 2.2B in your textbook for this activity. The summary from the textbook is as follows:</p>
<blockquote>
<p>How many species are common and how many are rare? One way to address this question is to construct a frequency distribution of species abundance. The data in Table 2.2-2 are from a survey of the breeding birds of Organ Pipe Cactus National Monument in southern Arizona, USA. The measurements were extracted from the North American Breeding Bird Survey, a continent-wide data set of estimated bird numbers (Sauer et al. 2003)</p>
</blockquote>
<p>The dataset consists of one table showing the abundance of 43 species in Organ Pipe National. Monument.</p>
<p>You can view and explore the data using this interactive table:</p>
<div id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43"],["Black Vulture","Turkey Vulture","Harris's Hawk","Red-tailed Hawk","American Kestrel","Gambel's Quail","Rock Dove","White-winged Dove","Mourning Dove","Greater Roadrunner","Great Horned Owl","Lesser Nighthawk","Black-chin. Hummingbird","Costa's Hummingbird","Gila Woodpecker","Ladder-back. Woodpecker","Gilded Flicker C","Ash-throated Flycatcher","Brown-crest. Flycatcher","Western Kingbird","Loggerhead Shrike","Bell's Vireo","Common Raven","Purple Martin","Violet-green Swallow","Verdin","Cactus Wren","Canyon Wren","Black-tail. Gnatcatcher","Northern Mockingbird","Curve-billed Thrasher","Phainopepla","Lucy's Warbler","Canyon Towhee","Black-throated Sparrow","Northern Cardinal","Great-tailed Grackle","Bronzed Cowbird","Brown-headed Cowbird","Hooded Oriole","Scott's Oriole","House Finch","House Sparrow"],[64,23,3,16,7,148,7,625,135,1,2,25,1,2,300,15,77,173,128,1,3,10,12,33,23,282,230,2,152,5,173,18,67,2,33,13,1,1,59,4,28,297,14]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>species<\/th>\n      <th>abundance<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Each row in the table represents a sample unit, or person. Thus the sample size is 88.</p>
<p>The variables are:</p>
<ul>
<li>
<strong>species</strong>. the name of the bird species, a <em>categorical</em> variable.</li>
<li>
<strong>abundance</strong>. the species’s abundance, a <em>numerical</em> variable consisting of positive integers.</li>
</ul>
<p>For our purposes, the only variable of interest is <em>abundance</em>. We will not use the species variable.</p>
</div>
<div id="read-and-view-the-bird-data" class="section level3">
<h3>
<span class="header-section-number">3.6.2</span> Read and view the bird data<a class="anchor" aria-label="anchor" href="#read-and-view-the-bird-data"><i class="fas fa-link"></i></a>
</h3>
<p>Create a new code section in your script named “bird abundances” and read the data from the textbook website:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bird_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://whitlockschluter.zoology.ubc.ca/wp-content/data/chapter02/chap02e2bDesertBirdAbundance.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; Rows: 43 Columns: 2</code></pre>
<pre><code>#&gt; ── Column specification ────────────────────────────────────────────────────────
#&gt; Delimiter: ","
#&gt; chr (1): species
#&gt; dbl (1): abundance</code></pre>
<pre><code>#&gt; 
#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.
#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bird_data</span>                  <span class="co"># print the data in the console</span></code></pre></div>
<pre><code>#&gt; # A tibble: 43 × 2
#&gt;   species          abundance
#&gt;   &lt;chr&gt;                &lt;dbl&gt;
#&gt; 1 Black Vulture           64
#&gt; 2 Turkey Vulture          23
#&gt; 3 Harris's Hawk            3
#&gt; 4 Red-tailed Hawk         16
#&gt; 5 American Kestrel         7
#&gt; 6 Gambel's Quail         148
#&gt; # … with 37 more rows</code></pre>
<p>The output in the console indicates the object is a tibble with 43 observations (rows) and 2 variables (columns): species and abundance.</p>
<p>It also indicates abundance has a data type of &lt;dbl&gt;, which is short for double, a numeric value with up to 18 decimal places. In other words, it’s <em>numerical</em> variable. The species variable, on the other hand, has a data type of &lt;chr&gt;, short for character, which means its a categorical variable.</p>
<p>Because abundance is numerical, not categorical, it does not make sense to view its distinct values with `distinct, or to create a contingency table showing the number of times each value occurs.</p>
<p>So let’s get straight to the histogram.</p>
</div>
<div id="make-a-histogram" class="section level3">
<h3>
<span class="header-section-number">3.6.3</span> Make a histogram<a class="anchor" aria-label="anchor" href="#make-a-histogram"><i class="fas fa-link"></i></a>
</h3>
<p>Like all ggplots, a histogram begins with a blank canvas. Notice that we set the data argument to <code>bird_data</code> this time rather than <code>tiger_data</code>.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bird_data</span><span class="op">)</span></code></pre></div>
<p>While we used <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> to create a bar graph, we will use <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> to create a histogram. The aesthetic mapping, however, is the same. Both require you to map the <code>x</code> argument, i.e. tell R which variable is on the x-axis. Because we are interested in looking at the distribution of abundance, we set the <code>x</code> argument to <code>abundance</code>:</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bird_data</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">abundance</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="inline-figure"><img src="lab-3_files/figure-html/unnamed-chunk-15-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>You will see a message in your console warning you that R used the default number of bins, which is 30. The one in your textbook uses bins that fall on the number 0, 50, 100, etc. Let’s try setting the bin width instead of the number of bins:</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bird_data</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">abundance</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-3_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>The number of bins looks better, but it appears the first bin is centered around zero rather than starting at zero. You can fix this with the boundary argument, which tells R where one of the bin boundaries is (all other boundaries can be inferred from that because the bin width is also set). Thus the boundaries will be 0, 50, 100, etc.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bird_data</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">abundance</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">50</span>,
                 boundary <span class="op">=</span> <span class="fl">0</span>, closed <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-3_files/figure-html/unnamed-chunk-17-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>This looks better, but not quite right. If you look at the raw data, you will see one data point for Gila woodpecker with an abundance of 300. Looking at this figure, it’s obvious that the value is being included in the bin to the left of 300 rather than the one to the right. In other words, the bins are 250-299, 300-349. We really want them to be 250-300 and 301-350.</p>
<p>Set the <code>closed</code> argument to <code>"left"</code> to change it so the left edge of the bin is included in the bin, not the right edge. The quick-minded might wonder if that makes the first bin (which includes both zero and 50) wider than the others. In short, I don’t know but it doesn’t matter here because there are no species in the dataset with an abundance of zero.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bird_data</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">abundance</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">50</span>,
                 boundary <span class="op">=</span> <span class="fl">0</span>, closed <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-3_files/figure-html/unnamed-chunk-18-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>And finally, clean it up with some axis labels and styling changes:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bird_data</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">abundance</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">50</span>,
                 boundary <span class="op">=</span> <span class="fl">0</span>, closed <span class="op">=</span> <span class="st">"left"</span>, 
                 fill <span class="op">=</span> <span class="st">"#C5351B"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Abundance"</span>, y <span class="op">=</span> <span class="st">"Frequency (number of species)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span>, <span class="fl">5</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span>, 
                     expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">600</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,
    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">rel</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-3_files/figure-html/unnamed-chunk-19-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="your-assignment" class="section level2">
<h2>
<span class="header-section-number">3.7</span> Your assignment<a class="anchor" aria-label="anchor" href="#your-assignment"><i class="fas fa-link"></i></a>
</h2>
<div id="instructions" class="section level3">
<h3>
<span class="header-section-number">3.7.1</span> Instructions<a class="anchor" aria-label="anchor" href="#instructions"><i class="fas fa-link"></i></a>
</h3>
<p>Your assignment is to demonstrate that you can create and interpret graphs using ggplot.</p>
<ol style="list-style-type: decimal">
<li><p>First, create a new <strong><em>R script</em></strong> in your lab 3 repository where you will build the code for your analysis. DO NOT TRY TO WRITE YOUR CODE IN YOUR LAB REPORT RMD. Keep your script neat with code sections and descriptive comments throughout.</p></li>
<li><p>Read the intro to each dataset (<a href="introduction-to-ggplot2.html#fireflies-data">Fireflies data</a>, <a href="introduction-to-ggplot2.html#bird-orders-data">Bird orders data</a>) and write the code <em>in your R script</em> to perform each analysis requested.</p></li>
<li><p><em>After</em> you have a working R script, complete your lab report R Markdown document. Open your lab-report.Rmd and replace all triple underscores “___” with your answers. Insert R code chunks where necessary and paste in code from your R script.</p></li>
<li><p>Put links to your Lab Report and any R scripts in your README</p></li>
<li><p>Knit your README.Rmd and lab-report.Rmd</p></li>
<li><p>Commit all changes and push. You can either do this step-by-step as your build your script and R Markdown documents, one file or code chunk at a time, or all at once at the end.</p></li>
<li><p>Conduct a round of peer review. Use the <a href="data-summarizing.html#grading-rubric-3">Grading Rubric</a> below. Put links to any peer review Issues you are involved in (as a reviewer or reviewee) into your Lab Report (There is a section in the template near the bottom).</p></li>
<li><p>Make any changes necessitated by peer review. It’s usually good to fix any code in your script first, to make sure it works, then copy the new code to your R Markdown document.</p></li>
<li><p>Save, knit, commit, and push. Save changes to any scripts, knit any updated Rmd files, commit all changes, and push to GitHub.</p></li>
<li><p>VERIFY ALL CHANGES ON YOUR REPO ON GITHUB. Look at your README, Lab Report, and any R scripts to make sure your changes actually made it to GitHub. Make sure the links on your README work.</p></li>
<li><p>Submit your assignment by copying the URL for your GitHub repository and pasting it into the appropriate Assignment Submission folder on D2L.</p></li>
</ol>
</div>
<div id="fireflies-data" class="section level3">
<h3>
<span class="header-section-number">3.7.2</span> Fireflies data<a class="anchor" aria-label="anchor" href="#fireflies-data"><i class="fas fa-link"></i></a>
</h3>
<p>This comes from Assignment question #19 in your textbook.</p>
<blockquote>
<p>Male fireflies of the species <em>Photinus ignitus</em> attract females with pulses of light. Flashes of longer duration seem to attract the most females. During mating, the male transfers a spermatophore to the female. Besides containing sperm, the spermatophore is rich in protein that is distributed by the female to her fertilized eggs. The data below are measurements of spermatophore mass (in mg) of 35 males (Cratsley and Lewis 2003). This question comes from your textbook.</p>
</blockquote>
<p>The path to the data is <code>"https://whitlockschluter.zoology.ubc.ca/wp-content/data/chapter02/chap02q19FireflySpermatophoreMass.csv"</code></p>
<p><strong>Create a graph depicting the frequency distribution of mass measurements. It should have legible text and appropriate axis labels.</strong></p>
</div>
<div id="bird-orders-data" class="section level3">
<h3>
<span class="header-section-number">3.7.3</span> Bird orders data<a class="anchor" aria-label="anchor" href="#bird-orders-data"><i class="fas fa-link"></i></a>
</h3>
<blockquote>
<p>The ebird_taxonomy dataset in the auk package is a simplified version of the taxonomy used by eBird. This taxonomy is based on the Clements Checklist. The dataset contains all known species of birds and their taxonomic order and family. Each observation (row) in the dataset represents a unique bird species.</p>
</blockquote>
<p>Add this code to your script to load the auk package and create a data object named birds, which you will use for your analysis.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/CornellLabofOrnithology/auk">auk</a></span><span class="op">)</span>                          <span class="co"># load the auk package</span>
<span class="va">birds</span> <span class="op">&lt;-</span> <span class="va">ebird_taxonomy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>           <span class="co"># start with the ebird_taxonomy data</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                     <span class="co"># tibbles print better in the console</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">category</span> <span class="op">==</span> <span class="st">"species"</span><span class="op">)</span>       <span class="co"># remove non-species taxa</span></code></pre></div>
<p><strong>Create a graph depicting the distribution of orders in the birds dataset. Sort the orders with the most frequent on the left.</strong></p>
</div>
<div id="grading-rubric-1" class="section level3">
<h3>
<span class="header-section-number">3.7.4</span> Grading Rubric<a class="anchor" aria-label="anchor" href="#grading-rubric-1"><i class="fas fa-link"></i></a>
</h3>
<p>You will be assessed based on the following rubric:</p>
<ul>
<li><p>GitHub Classroom repository claimed</p></li>
<li>
<p>R script</p>
<ul>
<li>
<p>Good organization</p>
<ul>
<li><p>Code sections make sense</p></li>
<li>
<p>Code goes in correct order, e.g.</p>
<ul>
<li>load packages before using them</li>
<li>read or load data before using it</li>
</ul>
</li>
<li><p>Blank lines between code chunks to make it easy to read</p></li>
</ul>
</li>
<li>
<p>Has sufficient comments</p>
<ul>
<li>At top, a line explaining purpose of the script</li>
<li>Each code chunk has a comment</li>
</ul>
</li>
<li><p>Code for plots works</p></li>
</ul>
</li>
<li>
<p>Lab Report (lab-report.md)</p>
<ul>
<li><p>Questions answered correctly</p></li>
<li>
<p>The two Figures are correct</p>
<ul>
<li>Figures look good (text appropriate size, etc)</li>
<li>Axis labels are correct</li>
</ul>
</li>
<li><p>Format of report is not significantly changed from the template (answers are easily distinguished from questions.</p></li>
<li><p>Links to peer-review Issues included</p></li>
<li><p>Session info included</p></li>
</ul>
</li>
<li><p>Lab report has been peer-reviewed at least once</p></li>
<li><p>README is complete</p></li>
<li><p>Submitted link to repository on D2L</p></li>
</ul>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="introduction-to-rstudio.html"><span class="header-section-number">2</span> Introduction to RStudio</a></div>
<div class="next"><a href="data-subsetting.html"><span class="header-section-number">4</span> Data subsetting</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#introduction-to-ggplot2"><span class="header-section-number">3</span> Introduction to ggplot2</a></li>
<li><a class="nav-link" href="#objectives-2"><span class="header-section-number">3.1</span> Objectives</a></li>
<li><a class="nav-link" href="#introduction"><span class="header-section-number">3.2</span> Introduction</a></li>
<li><a class="nav-link" href="#project-setup-1"><span class="header-section-number">3.3</span> Project Setup</a></li>
<li><a class="nav-link" href="#load-packages"><span class="header-section-number">3.4</span> Load packages</a></li>
<li>
<a class="nav-link" href="#bar-graphs"><span class="header-section-number">3.5</span> Bar graphs</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#example-tiger-data"><span class="header-section-number">3.5.1</span> Example: tiger data</a></li>
<li><a class="nav-link" href="#read-the-tiger-data"><span class="header-section-number">3.5.2</span> Read the tiger data</a></li>
<li><a class="nav-link" href="#view-the-tiger-data"><span class="header-section-number">3.5.3</span> View the tiger data</a></li>
<li><a class="nav-link" href="#frequency-table"><span class="header-section-number">3.5.4</span> Frequency table</a></li>
<li><a class="nav-link" href="#make-a-bar-graph"><span class="header-section-number">3.5.5</span> Make a bar graph</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#histograms"><span class="header-section-number">3.6</span> Histograms</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#example-bird-data"><span class="header-section-number">3.6.1</span> Example: bird data</a></li>
<li><a class="nav-link" href="#read-and-view-the-bird-data"><span class="header-section-number">3.6.2</span> Read and view the bird data</a></li>
<li><a class="nav-link" href="#make-a-histogram"><span class="header-section-number">3.6.3</span> Make a histogram</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#your-assignment"><span class="header-section-number">3.7</span> Your assignment</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#instructions"><span class="header-section-number">3.7.1</span> Instructions</a></li>
<li><a class="nav-link" href="#fireflies-data"><span class="header-section-number">3.7.2</span> Fireflies data</a></li>
<li><a class="nav-link" href="#bird-orders-data"><span class="header-section-number">3.7.3</span> Bird orders data</a></li>
<li><a class="nav-link" href="#grading-rubric-1"><span class="header-section-number">3.7.4</span> Grading Rubric</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/BIOL275-MSUM/BIOL275-MSUM.github.io/blob/master/lab-3.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/BIOL275-MSUM/BIOL275-MSUM.github.io/edit/master/lab-3.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Quantitative Biology BIOL 275 at MSUM</strong>" was written by Chris Merkord. It was last built on 2022-01-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
