<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>4 Lab 4: Data summarizing | Quantitative Biology BIOL 275 at MSUM</title>
<meta name="author" content="Chris Merkord">
<meta name="description" content="4.1 Objectives In this lab, you will learn to: Rename variables Create new variables Summarize a dataset as a whole or by groups Visualize the relationship between variables One numerical and one...">
<meta name="generator" content="bookdown 0.24.9 with bs4_book()">
<meta property="og:title" content="4 Lab 4: Data summarizing | Quantitative Biology BIOL 275 at MSUM">
<meta property="og:type" content="book">
<meta property="og:description" content="4.1 Objectives In this lab, you will learn to: Rename variables Create new variables Summarize a dataset as a whole or by groups Visualize the relationship between variables One numerical and one...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="4 Lab 4: Data summarizing | Quantitative Biology BIOL 275 at MSUM">
<meta name="twitter:description" content="4.1 Objectives In this lab, you will learn to: Rename variables Create new variables Summarize a dataset as a whole or by groups Visualize the relationship between variables One numerical and one...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1.9000/transition.js"></script><script src="libs/bs3compat-0.3.1.9000/tabs.js"></script><script src="libs/bs3compat-0.3.1.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><!-- <link rel="stylesheet" href="https://use.typekit.net/nvk0gxc.css"> --><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="styles.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Quantitative Biology BIOL 275 at MSUM</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li class="book-part">Lab Assignments</li>
<li><a class="" href="lab-1.html"><span class="header-section-number">1</span> Lab 1</a></li>
<li><a class="" href="lab-2-introduction-to-data-visualization.html"><span class="header-section-number">2</span> Lab 2: Introduction to data visualization</a></li>
<li><a class="" href="lab-3-data-subsetting.html"><span class="header-section-number">3</span> Lab 3: Data subsetting</a></li>
<li><a class="active" href="lab-4-data-summarizing.html"><span class="header-section-number">4</span> Lab 4: Data summarizing</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="laptop-setup.html"><span class="header-section-number">5</span> Laptop Setup</a></li>
<li class="book-part">Using RStudio</li>
<li><a class="" href="project-options.html"><span class="header-section-number">7</span> Project Options</a></li>
<li><a class="" href="code-sections.html"><span class="header-section-number">8</span> Code Sections</a></li>
<li><a class="" href="r-markdown-documents.html"><span class="header-section-number">9</span> R Markdown documents</a></li>
<li><a class="" href="session-info.html"><span class="header-section-number">10</span> Session info</a></li>
<li class="book-part">Git and GitHub</li>
<li><a class="" href="about-git-and-github.html"><span class="header-section-number">12</span> About Git and GitHub</a></li>
<li><a class="" href="github-notifications.html"><span class="header-section-number">13</span> GitHub Notifications</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/BIOL275-MSUM/BIOL275-MSUM.github.io">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="lab-4-data-summarizing" class="section level1">
<h1>
<span class="header-section-number">4</span> Lab 4: Data summarizing<a class="anchor" aria-label="anchor" href="#lab-4-data-summarizing"><i class="fas fa-link"></i></a>
</h1>
<div id="objectives-2" class="section level2">
<h2>
<span class="header-section-number">4.1</span> Objectives<a class="anchor" aria-label="anchor" href="#objectives-2"><i class="fas fa-link"></i></a>
</h2>
<p>In this lab, you will learn to:</p>
<ul>
<li><p>Rename variables</p></li>
<li><p>Create new variables</p></li>
<li><p>Summarize a dataset as a whole or by groups</p></li>
<li>
<p>Visualize the relationship between variables</p>
<ul>
<li>One numerical and one categorical variable</li>
<li>Two numerical variables</li>
<li>Three variables</li>
</ul>
</li>
</ul>
</div>
<div id="introduction-1" class="section level2">
<h2>
<span class="header-section-number">4.2</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-1"><i class="fas fa-link"></i></a>
</h2>
<p>Visualizing data is a key step in the data science workflow, but it is rarely the first step. Sometimes you only need part of a dataset to answer your question, which is why the previous lab, <a href="data-subsetting.html">Data subsetting</a>, introduced you to methods for extracting a subset of observations or variables from a table. At other times, you may need to create new variables from the original ones, or you may need to calculate summary statistic for a dataset or for groups within a dataset. This lab will introduce you to methods for that using the <code>diamonds</code> dataset from the <strong>ggplot2</strong> package and new functions from the <strong>dplyr</strong> package.</p>
<p>In this lab you will:</p>
<ul>
<li>Rename variables with <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code>
</li>
<li>Create new variables with mutate <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>
</li>
<li>Summarize a dataset with <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>
</li>
</ul>
<div id="packages" class="section level3">
<h3>
<span class="header-section-number">4.2.1</span> Packages<a class="anchor" aria-label="anchor" href="#packages"><i class="fas fa-link"></i></a>
</h3>
<p>In this lab you will use functions and datasets from the <strong>dplyr</strong> and <strong>ggplot2</strong> packages. While you could load those packages individually, in this course you are encouraged to always load the entire <strong>tidyverse</strong> set of packages.</p>
<p>Load the <strong>tidyverse</strong> package:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>    <span class="co"># load the tidyverse package</span></code></pre></div>
</div>
<div id="diamonds-data" class="section level3">
<h3>
<span class="header-section-number">4.2.2</span> <code>diamonds</code> data<a class="anchor" aria-label="anchor" href="#diamonds-data"><i class="fas fa-link"></i></a>
</h3>
<p>In addition to getting us access to dplyr packages, loading the <strong>tidyverse</strong> package also lets us access the <code>diamonds</code> dataset from the <strong>ggplot2</strong> package. This lab will use the <code>diamonds</code> dataset to show examples of renaming, mutating, summarizing, and graphing.</p>
<p>You can read more about the <code>diamonds</code> dataset in the previous lab, <a href="data-subsetting.html">Data subsetting</a>.</p>
</div>
</div>
<div id="rename-variables-with-rename" class="section level2">
<h2>
<span class="header-section-number">4.3</span> Rename variables with <code>rename()</code><a class="anchor" aria-label="anchor" href="#rename-variables-with-rename"><i class="fas fa-link"></i></a>
</h2>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> function allows you to rename variables in a data frame. The first argument to <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> is the data frame. The other arguments specify which variables to rename, with the format <code>new_name = old_name</code>.</p>
<p>For example, say you want to rename the <code>x</code>, <code>y</code>, and <code>z</code> variables to <code>length</code>, <code>width</code>, and <code>height</code>:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="va">diamonds</span>, length <span class="op">=</span> <span class="va">x</span>, width <span class="op">=</span> <span class="va">y</span>, height <span class="op">=</span> <span class="va">z</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 53,940 × 10
#&gt;   carat cut       color clarity depth table price length width height
#&gt;   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
#&gt; 1  0.23 Ideal     E     SI2      61.5    55   326   3.95  3.98   2.43
#&gt; 2  0.21 Premium   E     SI1      59.8    61   326   3.89  3.84   2.31
#&gt; 3  0.23 Good      E     VS1      56.9    65   327   4.05  4.07   2.31
#&gt; 4  0.29 Premium   I     VS2      62.4    58   334   4.2   4.23   2.63
#&gt; 5  0.31 Good      J     SI2      63.3    58   335   4.34  4.35   2.75
#&gt; 6  0.24 Very Good J     VVS2     62.8    57   336   3.94  3.96   2.48
#&gt; # … with 53,934 more rows</code></pre>
<p>Note the lack of quotes around the names of the data frame, the new variable names or the old variables names</p>
<p>The more arguments there are to a function, the harder it is to read. If your line of code gets too long, or is hard to read, try putting each argument on its own line like this:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>
  <span class="va">diamonds</span>, 
  length <span class="op">=</span> <span class="va">x</span>, 
  width <span class="op">=</span> <span class="va">y</span>, 
  height <span class="op">=</span> <span class="va">z</span>
<span class="op">)</span></code></pre></div>
<p>This makes the code more readable. Just be sure you have commas after each argument except the last, and don’t forget the closing parenthesis on its own line</p>
</div>
<div id="create-new-variables-with-mutate" class="section level2">
<h2>
<span class="header-section-number">4.4</span> Create new variables with <code>mutate()</code><a class="anchor" aria-label="anchor" href="#create-new-variables-with-mutate"><i class="fas fa-link"></i></a>
</h2>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> function allows you to create a new variable in a data frame. As with other dplyr functions, the first argument to <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> is the data frame. Additional arguments are name-value pairs. The name gives the name of the column in the output. The value is often a mathematical expression (in the case of numerical variables), a function, or some combination of both.</p>
<p>Let’s do an example using the diamonds dataset. To make viewing the new variables easier, first select a subset of variables from the <code>diamonds</code> data set using <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> and give the new data frame the name <code>d2</code>:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># select the variables of interest</span>
<span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">diamonds</span>, <span class="va">carat</span>, <span class="va">price</span><span class="op">)</span>
<span class="va">d2</span></code></pre></div>
<pre><code>#&gt; # A tibble: 53,940 × 2
#&gt;   carat price
#&gt;   &lt;dbl&gt; &lt;int&gt;
#&gt; 1  0.23   326
#&gt; 2  0.21   326
#&gt; 3  0.23   327
#&gt; 4  0.29   334
#&gt; 5  0.31   335
#&gt; 6  0.24   336
#&gt; # … with 53,934 more rows</code></pre>
<p>Now use the new data frame <code>d2</code> to calculate the price per carat for each diamond. You can call the new variable anything you want. In this example, it is named <code>ppc</code> (“price per carat”):</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># example of creating price per carat (ppc)</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">d2</span>, ppc <span class="op">=</span> <span class="va">price</span> <span class="op">/</span> <span class="va">carat</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 53,940 × 3
#&gt;   carat price   ppc
#&gt;   &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
#&gt; 1  0.23   326 1417.
#&gt; 2  0.21   326 1552.
#&gt; 3  0.23   327 1422.
#&gt; 4  0.29   334 1152.
#&gt; 5  0.31   335 1081.
#&gt; 6  0.24   336 1400 
#&gt; # … with 53,934 more rows</code></pre>
<div id="mutate-an-existing-variable" class="section level3">
<h3>
<span class="header-section-number">4.4.1</span> <code>mutate()</code> an existing variable<a class="anchor" aria-label="anchor" href="#mutate-an-existing-variable"><i class="fas fa-link"></i></a>
</h3>
<p>You do not have to create an entirely new variable when using <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>. For example, let’s say you wanted to convert the price from US Dollars (USD) to Canadian Dollars (CAD). The current exchange rate is about 1 USD to 1.27 CAD. You can overwrite the existing price variable by setting the new variable name to be the same as the old variable name:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">diamonds</span>, price <span class="op">=</span> <span class="va">price</span> <span class="op">*</span> <span class="fl">1.27</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 53,940 × 10
#&gt;   carat cut       color clarity depth table price     x     y     z
#&gt;   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1  0.23 Ideal     E     SI2      61.5    55  414.  3.95  3.98  2.43
#&gt; 2  0.21 Premium   E     SI1      59.8    61  414.  3.89  3.84  2.31
#&gt; 3  0.23 Good      E     VS1      56.9    65  415.  4.05  4.07  2.31
#&gt; 4  0.29 Premium   I     VS2      62.4    58  424.  4.2   4.23  2.63
#&gt; 5  0.31 Good      J     SI2      63.3    58  425.  4.34  4.35  2.75
#&gt; 6  0.24 Very Good J     VVS2     62.8    57  427.  3.94  3.96  2.48
#&gt; # … with 53,934 more rows</code></pre>
</div>
</div>
<div id="summarize-a-data-set-with-summarize" class="section level2">
<h2>
<span class="header-section-number">4.5</span> Summarize a data set with <code>summarize()</code><a class="anchor" aria-label="anchor" href="#summarize-a-data-set-with-summarize"><i class="fas fa-link"></i></a>
</h2>
<p>You can summarize a data set using the <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> function. Like other dplyr functions, the first argument to <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> is the data frame. Additional arguments are name-value pairs, just like with <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>. Values are set using various summary functions such as <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> or <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code> (standard deviation). The difference is that whereas <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> returns a data frame with the same number of rows as the input data frame, <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> returns a data frame with only one row, and the only variables in the new data frame are the ones you named in <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>. For example, to calculate the mean value of the <code>carat</code> variable, the code would look like this:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span><span class="va">diamonds</span>, mean_carat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">carat</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 × 1
#&gt;   mean_carat
#&gt;        &lt;dbl&gt;
#&gt; 1      0.798</code></pre>
<p>You can calculate multiple summary statistics at the same time by providing a comma-separated list of name-value pairs. Because the line starts getting long, this example has each argument on its own line, but it would work just fine if everything was on the same line.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>
  <span class="va">diamonds</span>,
  mean_carat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">carat</span><span class="op">)</span>, 
  sd_carat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">carat</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div id="summary-functions" class="section level3">
<h3>
<span class="header-section-number">4.5.1</span> Summary functions<a class="anchor" aria-label="anchor" href="#summary-functions"><i class="fas fa-link"></i></a>
</h3>
<p>There are a wide variety of functions you can use to summarize a variable. Here are some examples:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/Extremes.html">max()</a></code> - maximum value</li>
<li>
<code><a href="https://rdrr.io/r/base/Extremes.html">min()</a></code> - minimum value</li>
<li>
<code><a href="https://rdrr.io/r/stats/median.html">median()</a></code> - median value</li>
<li>
<code><a href="https://rdrr.io/r/base/mode.html">mode()</a></code> mode</li>
<li>
<code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code> standard deviation</li>
<li>
<code><a href="https://rdrr.io/r/stats/cor.html">var()</a></code> variance</li>
<li>
<code><a href="https://rdrr.io/r/stats/IQR.html">IQR()</a></code> interquartile range</li>
</ul>
<p>For each of those functions, you must put the name of the variable you want to summarize <em>inside</em> the given function as the first argument.</p>
<div id="sample-size" class="section level4">
<h4>
<span class="header-section-number">4.5.1.1</span> Sample size<a class="anchor" aria-label="anchor" href="#sample-size"><i class="fas fa-link"></i></a>
</h4>
<p>There is also a special summary function <code><a href="https://dplyr.tidyverse.org/reference/context.html">n()</a></code> which returns the number of rows, i.e. the sample size. Here is an example:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span><span class="va">diamonds</span>, sampl_size <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 × 1
#&gt;   sampl_size
#&gt;        &lt;int&gt;
#&gt; 1      53940</code></pre>
</div>
<div id="quantiles" class="section level4">
<h4>
<span class="header-section-number">4.5.1.2</span> Quantiles<a class="anchor" aria-label="anchor" href="#quantiles"><i class="fas fa-link"></i></a>
</h4>
<p>Some summary functions require one or more arguments in addition to the name of the variable to summarize.</p>
<p>One example is the <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code> function, whose <code>probs</code> argument is the probability you want to calculate the quantile for. For example, to calculate the first quartile (0.25 quantile) of the variable <code>carat</code>, you can use the quantile function with the argument of <code>probs = 0.25</code>:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span><span class="va">diamonds</span>, q1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">carat</span>, probs <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 × 1
#&gt;      q1
#&gt;   &lt;dbl&gt;
#&gt; 1   0.4</code></pre>
</div>
</div>
<div id="combine-functions-and-equations" class="section level3">
<h3>
<span class="header-section-number">4.5.2</span> Combine functions and equations<a class="anchor" aria-label="anchor" href="#combine-functions-and-equations"><i class="fas fa-link"></i></a>
</h3>
<p>When summarizing, you can use both functions and mathematical operators when creating a new variable. For example, here is code that calculates the standard error of the mean for the <code>price</code> variable. Remember that standard error is equal to the standard deviation divided by the square root of the sample size:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>
  <span class="va">diamonds</span>, 
  sem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 × 1
#&gt;     sem
#&gt;   &lt;dbl&gt;
#&gt; 1  17.2</code></pre>
<p>Notice that the equation for standard error (sem) above uses both the <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code> function and the <code><a href="https://dplyr.tidyverse.org/reference/context.html">n()</a></code> function.</p>
<p>Alternative, you could summarize the mean and sample size first and then use those new variables for creating a third variable. In the example below we calculate the mean and sample size first, use those to calculate the standard error, and then use that to calculate an approximate 95% confidence interval:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>
  <span class="va">diamonds</span>, 
  mean_p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span>,
  sd_p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span>,
  sampl_size <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,
  sem <span class="op">=</span> <span class="va">sd_p</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sampl_size</span><span class="op">)</span>,
  ci_upper_limit <span class="op">=</span> <span class="va">mean_p</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">sem</span>,
  ci_lower_limit <span class="op">=</span> <span class="va">mean_p</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">sem</span>
<span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 × 6
#&gt;   mean_p  sd_p sampl_size   sem ci_upper_limit ci_lower_limit
#&gt;    &lt;dbl&gt; &lt;dbl&gt;      &lt;int&gt; &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;
#&gt; 1  3933. 3989.      53940  17.2          3966.          3899.</code></pre>
</div>
</div>
<div id="summarize-a-data-set-by-groups" class="section level2">
<h2>
<span class="header-section-number">4.6</span> Summarize a data set by groups<a class="anchor" aria-label="anchor" href="#summarize-a-data-set-by-groups"><i class="fas fa-link"></i></a>
</h2>
<p>In the previous section you learned how to use <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> combined with a summary functions such as <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> and <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code> to calculate statistics for all observations (rows) in a data set.</p>
<p>A common goal in data transformation, however, is to calculate statistics for <em>groups</em> of observations rather than all observations together. For example, in a university course with two sections, you may want to calculate mean scores for each section instead of the class as a whole.</p>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> function combined with the <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> function lets you calculated summary statistics for groups of observations. The groups are identified by a categorical variable called the grouping variable, while the statistics are calculated from one or more other variables.</p>
<p>For example, let’s explore how the mean price varies with the cut of a diamond in the <code>diamonds</code> data set.</p>
<p>In the first step, you use <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> to produced a grouped data frame. Like other dplyr verbs, the first argument to <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> is the name of the dataset. Additional arguments identify the variables you want to group by. In this example, we group the diamonds dataset by the <code>cut</code> variable and assign the resulting grouped data frame a new name, <code>diamonds_grouped</code>:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diamonds_grouped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">diamonds</span>, <span class="va">cut</span><span class="op">)</span>
<span class="va">diamonds_grouped</span></code></pre></div>
<pre><code>#&gt; # A tibble: 53,940 × 10
#&gt; # Groups:   cut [5]
#&gt;   carat cut       color clarity depth table price     x     y     z
#&gt;   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1  0.23 Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43
#&gt; 2  0.21 Premium   E     SI1      59.8    61   326  3.89  3.84  2.31
#&gt; 3  0.23 Good      E     VS1      56.9    65   327  4.05  4.07  2.31
#&gt; 4  0.29 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63
#&gt; 5  0.31 Good      J     SI2      63.3    58   335  4.34  4.35  2.75
#&gt; 6  0.24 Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48
#&gt; # … with 53,934 more rows</code></pre>
<p>The only difference in the output from printing the ungrouped <code>diamonds</code> table is the second line of the output, which now says <code># Groups:   cut [5]</code>. That’s saying the table is grouped by the <code>cut</code> variable and there are five groups (the five possible values of <code>cut</code>).</p>
<p>The next step is to summarize the grouped data frame, just like you summarized the ungrouped data frame in the previous section:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span><span class="va">diamonds_grouped</span>, mean_price <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 5 × 2
#&gt;   cut       mean_price
#&gt;   &lt;ord&gt;          &lt;dbl&gt;
#&gt; 1 Fair           4359.
#&gt; 2 Good           3929.
#&gt; 3 Very Good      3982.
#&gt; 4 Premium        4584.
#&gt; 5 Ideal          3458.</code></pre>
</div>
<div id="quick-contingency-tables" class="section level2">
<h2>
<span class="header-section-number">4.7</span> Quick contingency tables<a class="anchor" aria-label="anchor" href="#quick-contingency-tables"><i class="fas fa-link"></i></a>
</h2>
<p>Counting the number of observations by group is a fairly common task, especially when you are exploring your data interactively in an R session (e.g. by typing commands into the console). One way to do this would be to use a grouped summary and the <code><a href="https://dplyr.tidyverse.org/reference/context.html">n()</a></code> function as described above, for example:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diamonds</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cut</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 5 × 2
#&gt;   cut           n
#&gt;   &lt;ord&gt;     &lt;int&gt;
#&gt; 1 Fair       1610
#&gt; 2 Good       4906
#&gt; 3 Very Good 12082
#&gt; 4 Premium   13791
#&gt; 5 Ideal     21551</code></pre>
<p>Because it is such a common task, dplyr includes a special function <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> to do just that but in fewer commands:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">diamonds</span>, <span class="va">cut</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 5 × 2
#&gt;   cut           n
#&gt;   &lt;ord&gt;     &lt;int&gt;
#&gt; 1 Fair       1610
#&gt; 2 Good       4906
#&gt; 3 Very Good 12082
#&gt; 4 Premium   13791
#&gt; 5 Ideal     21551</code></pre>
<p>You can also do this to create a quick contingency table for multiple variables:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">diamonds</span>, <span class="va">cut</span>, <span class="va">clarity</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 40 × 2
#&gt;   cut       clarity
#&gt;   &lt;ord&gt;     &lt;ord&gt;  
#&gt; 1 Ideal     SI2    
#&gt; 2 Premium   SI1    
#&gt; 3 Good      VS1    
#&gt; 4 Premium   VS2    
#&gt; 5 Good      SI2    
#&gt; 6 Very Good VVS2   
#&gt; # … with 34 more rows</code></pre>
<p>If you just want to see the distinct values (levels) of a categorical variable, or the combinations of values for two or more categorical variables in a dataset, but you don’t need the counts, there is an even simpler function <code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code> for that:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">diamonds</span>, <span class="va">cut</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 5 × 1
#&gt;   cut      
#&gt;   &lt;ord&gt;    
#&gt; 1 Ideal    
#&gt; 2 Premium  
#&gt; 3 Good     
#&gt; 4 Very Good
#&gt; 5 Fair</code></pre>
<p>The functions <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code> are useful when you want to get a quick handle on your categorical variables.</p>
</div>
<div id="visualize-a-categorical-and-numerical-variable" class="section level2">
<h2>
<span class="header-section-number">4.8</span> Visualize a categorical and numerical variable<a class="anchor" aria-label="anchor" href="#visualize-a-categorical-and-numerical-variable"><i class="fas fa-link"></i></a>
</h2>
<p>In the Introduction to ggplot2 lab, you <a href="https://biol275-msum.github.io/introduction-to-ggplot2.html#histograms">learned how to create a histogram</a> to visualize the distribution of a single numerical variable. But what if you want to look at how <em>two</em> variables are related? For example, say you want to visualize the relationship between the cut and price of diamonds we summarized in the previous example.</p>
<p>Here you will learn two ways to visualize the joint distribution of a numerical variable and a categorical variable:</p>
<ol style="list-style-type: decimal">
<li>Multiple histograms</li>
<li>Strip plots</li>
</ol>
<div id="multiple-histograms" class="section level3">
<h3>
<span class="header-section-number">4.8.1</span> Multiple histograms<a class="anchor" aria-label="anchor" href="#multiple-histograms"><i class="fas fa-link"></i></a>
</h3>
<p>A common way of comparing multiple distributions is to create a single graph with multiple histograms, one for each variable or subset of observations.</p>
<p>The <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> function in ggplot2 allows you to take a plot and split it up into multiple plots based on some categorical variable. The first argument to <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> is an expression of the form <code>~ var_name</code> where <code>var_name</code> is the name of the grouping variable.</p>
<p>First, let’s start by graphing the distribution of the <code>price</code> variable without regard to cut. We will set the number of bin width to 500 (dollars)</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">price</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-4_files/figure-html/unnamed-chunk-7-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Interestingly, the distribution appears to be bimodal, with the second, smaller mode around 4500.</p>
<p>Now lets plot the same graph but add the <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> function. Remember to add a plus sign <code>+</code> at the end of the <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> so R knows you are trying add another layer to the graph:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">price</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">cut</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-4_files/figure-html/unnamed-chunk-8-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>The resulting plot now has five small graphs, called facets in tidyverse lingo, each labeled with the value of <code>cut</code> it represents.</p>
<p>A common issue when faceting is that all facets have the same x and y axis limits. For example, in the graph above, the y axis ranges from 0 to about 5500, but the highest count for Fair cut diamonds is less than 200 because there are far fewer of these diamonds sold. If you goal is to show the <em>distribution</em> of prices rather than the relative sample size of the each cut, it makes more sense to let the y axis scale vary based on the data. You can accomplish this with the <code>scales</code> argument to <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code>:</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">price</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">cut</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-4_files/figure-html/unnamed-chunk-9-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>The <code>scales</code> argument can be set to <code>"free_y"</code>, <code>"free_x"</code>, or <code>"free"</code> to allow both axes to vary.</p>
<p>Other useful arguments to <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> include <code>nrow</code> and <code>ncol</code>, one of which can be used to specify how many rows or columns the resulting facets should form. With histograms, it’s common to put them all in one column so you can compare the shape of the distributions more easily.</p>
</div>
<div id="strip-plots" class="section level3">
<h3>
<span class="header-section-number">4.8.2</span> Strip plots<a class="anchor" aria-label="anchor" href="#strip-plots"><i class="fas fa-link"></i></a>
</h3>
<p>Strip charts are another common way to visualize the relationship between a numerical variable and a categorical variable. For this kind of plot, you use the <code><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter()</a></code> function. Unlike a histogram, which creates the y axis for you by counting the number of rows, a strip chart requires you to specify both the x and y axes in the aesthetic mapping. Most often the categorical variable is the explanatory variable and is placed on the x axis:</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cut</span>, y <span class="op">=</span> <span class="va">price</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-4_files/figure-html/unnamed-chunk-10-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>As you can see, there is quite a bit of overplotting. This makes it more difficult to estimate the density of points in any part of the graph. If overplotting is minor, one solution is to use hollow circles instead of filled ones by altering the <code>shape</code> argument to <code><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter()</a></code>. With severe overplotting like this, a better strategy is to make the points semi-transparent by setting the <code>alpha</code> argument to something low like 0.1 indicating 10% opacity.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cut</span>, y <span class="op">=</span> <span class="va">price</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-4_files/figure-html/unnamed-chunk-11-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>One nice thing about strip plots is that they make it easy to view the both the raw data <em>and</em> summary statistics such as the means and confidence intervals.</p>
<p>The trick to adding summary statistics to a ggplot based on raw data is that you have to first create a new data frame containing the summary statistics. If you remember, we summarized the price by cut like this:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span><span class="va">diamonds_grouped</span>, mean_price <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Let’s expand that a bit to include upper and lower confidence limits:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">price_summary</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>
    <span class="va">diamonds_grouped</span>, 
    mean_price <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span>,
    sem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,
    ci_upper_limit <span class="op">=</span> <span class="va">mean_price</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">sem</span>,
    ci_lower_limit <span class="op">=</span> <span class="va">mean_price</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">sem</span>
  <span class="op">)</span>
<span class="va">price_summary</span></code></pre></div>
<pre><code>#&gt; # A tibble: 5 × 5
#&gt;   cut       mean_price   sem ci_upper_limit ci_lower_limit
#&gt;   &lt;ord&gt;          &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;
#&gt; 1 Fair           4359.  88.7          4533.          4185.
#&gt; 2 Good           3929.  52.6          4032.          3826.
#&gt; 3 Very Good      3982.  35.8          4052.          3912.
#&gt; 4 Premium        4584.  37.0          4657.          4512.
#&gt; 5 Ideal          3458.  25.9          3508.          3407.</code></pre>
<p>Now that you have the summary statistics, add the means to the graph using the <code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_crossbar()</a></code> function. Because the crossbars will be based on the summary data, not the raw data, you will need to specify a new data argument and aesthetic mappings. The required aesthetics for <code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_crossbar()</a></code> are <code>y</code>, <code>ymin</code>, and <code>ymax</code>. Setting the color to red will make the crossbars stand out against the black raw data points.</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cut</span>, y <span class="op">=</span> <span class="va">price</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_crossbar</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">price_summary</span>, 
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cut</span>, y <span class="op">=</span> <span class="va">mean_price</span>, ymax <span class="op">=</span> <span class="va">ci_upper_limit</span>, 
                  ymin <span class="op">=</span> <span class="va">ci_lower_limit</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"red"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-4_files/figure-html/jitter-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>The boxes showing the 95% confidence intervals do not show up well because the sample sizes are so large. For a better idea of what they look like, and examples of other types of errors bars, see <a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">Vertical intervals: lines, crossbars &amp; errorbars</a> on the <a href="https://ggplot2.tidyverse.org/reference/index.html">Reference</a> page of the <a href="https://ggplot2.tidyverse.org/index.html">ggplot2 website</a>.</p>
</div>
</div>
<div id="visualize-two-numerical-variables" class="section level2">
<h2>
<span class="header-section-number">4.9</span> Visualize two numerical variables<a class="anchor" aria-label="anchor" href="#visualize-two-numerical-variables"><i class="fas fa-link"></i></a>
</h2>
<p>The most basic type of graph for visualizing the relationship between two numerical variables is the scatterplot. The <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> function can be used to add points two a graph. When it is used with numerical variables for the <code>x</code> and <code>y</code> aesthetics, the result is a scatterplot.</p>
<p>For example, the following graph shows the relationship between carat and price:</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">carat</span>, y <span class="op">=</span> <span class="va">price</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-4_files/figure-html/unnamed-chunk-13-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Looking at the graph it is clear that as the weight of the diamond increases, so does the price.</p>
<div id="plotting-three-variables" class="section level3">
<h3>
<span class="header-section-number">4.9.1</span> Plotting three variables<a class="anchor" aria-label="anchor" href="#plotting-three-variables"><i class="fas fa-link"></i></a>
</h3>
<p>In order to more fully explore the relationships between multiple variables, it is sometimes useful the visualize them at the same time. For example, what if you wanted to see how cut, price, and carat are related?</p>
<p>One way to do this might be to use <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> to create a separate scatter plot for each cut.</p>
<p>A common alternative is to add a third aesthetic to the plot to differentiate points in some other way than by their x and y coordinates. These aesthetics include <code>color</code>, <code>size</code>, <code>shape</code>, and <code>alpha</code> for points, and <code>linetype</code> for lines. See the ggplot2 documentation on <a href="https://ggplot2.tidyverse.org/articles/ggplot2-specs.html">Aesthetic specifications</a> for examples.</p>
<p>The following code plots the same scatter plot as above, but with the color aesthetic mapped to the cut variable. To reduce overplotting, the alpha level has been reduced to 0.3.</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">carat</span>, y <span class="op">=</span> <span class="va">price</span>, color <span class="op">=</span> <span class="va">cut</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="lab-4_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="assignment-2" class="section level2">
<h2>
<span class="header-section-number">4.10</span> Assignment<a class="anchor" aria-label="anchor" href="#assignment-2"><i class="fas fa-link"></i></a>
</h2>
<p>First, create a new R script named <code>assignment.R</code>. At the top of the script, add code to load the tidyverse package.</p>
<p>For your assignment, you will work with the famous Edgar Anderson <code>iris</code> data set, which gives the measurements in centimeters of the variables sepal length and width and petal length and width, respectively, for 50 flowers from each of 3 species of iris. The species are <em>Iris setosa</em>, <em>versicolor</em>, and <em>virginica</em>.</p>
<p>You can print <code>iris</code> in the console to see the data set, but because it is a basic data frame and not an enhanced tibble, it will not print in the user-friendly manner of tibbles that you are used to. To have it print more nicely, turn it into a tibble first.</p>
<p>Add this to your script:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iris</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span> <span class="co"># so it prints a little nicer</span></code></pre></div>
<p>Note that when you do this, iris will now show up in your Environment tab.</p>
<div id="questions-1" class="section level3">
<h3>
<span class="header-section-number">4.10.1</span> Questions<a class="anchor" aria-label="anchor" href="#questions-1"><i class="fas fa-link"></i></a>
</h3>
<p>Now use what you know from previous labs, and what you have learned from today’s lab, to perform the following data manipulation tasks. For each question, put a comment like <code># question 1</code> on the line before, so you can read your script more easily, and follow each answer with a blank line to improve readability.</p>
<p>For each answer, you can simply print the resulting table. You do not need to assign it a name. Some questions have more than one part, e.g. you need to use multiple dplyr functions in a row. You may use intermediate objects for this, but you are encouraged to try <a href="Combine%20multiple%20operations%20with%20the%20pipe">combining multiple operations with the pipe</a>.</p>
<ol style="list-style-type: decimal">
<li><p>Rename each variable so that it is all lower-case and uses an underscore <code>_</code> instead of a period <code>.</code> in the name (the recommended coding style in the <a href="https://style.tidyverse.org/syntax.html">tidyverse style guide</a>)</p></li>
<li><p>Convert the four numerical variables from cm to mm by multiplying by 10</p></li>
<li><p>Calculate sepal area and petal area (area is equal to length multiplied by width). Print a table with <em>only</em> the variables sepal area, petal area, and species.</p></li>
<li>
<p>Calculate the following statistics for the <em>entire dataset</em> from the sepal length variable and print the resulting table:</p>
<ol style="list-style-type: lower-alpha">
<li>sample size</li>
<li>maximum value</li>
<li>minimum value</li>
<li>range</li>
<li>median</li>
<li>first quartile (q1)</li>
<li>third quartile (q2)</li>
<li>inter-quartile range (iqr)</li>
</ol>
<p>Your answer should be a tibble with exactly one row</p>
</li>
<li>
<p>Calculate the following statistics <span class="ul">for each species</span> from the <strong>petal width</strong> variable and print the resulting table:</p>
<ol style="list-style-type: lower-alpha">
<li>sample size</li>
<li>mean</li>
<li>standard deviation</li>
<li>variance</li>
<li>standard error of the mean</li>
<li>approximate 95% confidence interval</li>
</ol>
</li>
<li><p>Visualize the relationship between <strong>petal width</strong> and <strong>species</strong> using a strip plot.</p></li>
<li><p>Starting with the previous graph, add the mean and 95% confidence interval for each species</p></li>
<li><p>Visualize the relationship between petal length, petal width, and species using a scatter plot. Map the two numerical variables to the x and y axes and map species to the color and shape aesthetics.</p></li>
</ol>
</div>
<div id="submission-2" class="section level3">
<h3>
<span class="header-section-number">4.10.2</span> Submission<a class="anchor" aria-label="anchor" href="#submission-2"><i class="fas fa-link"></i></a>
</h3>
<p>When you have completed the questions listed above, save your files, commit your changes, and push them to GitHub.</p>
<p>Then copy the URL to your GitHub repository and submit that to the Assignment on D2L.</p>
</div>
</div>
<div id="submission-3" class="section level2">
<h2>
<span class="header-section-number">4.11</span> Submission<a class="anchor" aria-label="anchor" href="#submission-3"><i class="fas fa-link"></i></a>
</h2>
<p>When you have completed the questions listed above, save your files, commit your changes, and push them to GitHub.</p>
<p>Then copy the URL to your GitHub repository and submit that to the Assignment on D2L.</p>
</div>
<div id="further-reading-1" class="section level2">
<h2>
<span class="header-section-number">4.12</span> Further reading<a class="anchor" aria-label="anchor" href="#further-reading-1"><i class="fas fa-link"></i></a>
</h2>
<p>Your lab manual, <em>R for Data Science</em> (R4DS), contains detailed instructions on mutating, grouping, and summarizing in <a href="https://r4ds.had.co.nz/transform.html">Chapter 5: Data transformation</a>.</p>
<p>You do not need to read the chapter, but it would certainly help solidify the concepts introduced in this lab.</p>
<p>If you do want to read the chapter and try their examples in your own R Script then don’t forget to install the nycflights13 package as described in <a href="https://r4ds.had.co.nz/introduction.html?q=nycflights13#other-packages">R4DS Section 1.4.4 Other Packages</a>.</p>

</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="lab-3-data-subsetting.html"><span class="header-section-number">3</span> Lab 3: Data subsetting</a></div>
<div class="next"><a href="laptop-setup.html"><span class="header-section-number">5</span> Laptop Setup</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#lab-4-data-summarizing"><span class="header-section-number">4</span> Lab 4: Data summarizing</a></li>
<li><a class="nav-link" href="#objectives-2"><span class="header-section-number">4.1</span> Objectives</a></li>
<li>
<a class="nav-link" href="#introduction-1"><span class="header-section-number">4.2</span> Introduction</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#packages"><span class="header-section-number">4.2.1</span> Packages</a></li>
<li><a class="nav-link" href="#diamonds-data"><span class="header-section-number">4.2.2</span> diamonds data</a></li>
</ul>
</li>
<li><a class="nav-link" href="#rename-variables-with-rename"><span class="header-section-number">4.3</span> Rename variables with rename()</a></li>
<li>
<a class="nav-link" href="#create-new-variables-with-mutate"><span class="header-section-number">4.4</span> Create new variables with mutate()</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#mutate-an-existing-variable"><span class="header-section-number">4.4.1</span> mutate() an existing variable</a></li></ul>
</li>
<li>
<a class="nav-link" href="#summarize-a-data-set-with-summarize"><span class="header-section-number">4.5</span> Summarize a data set with summarize()</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#summary-functions"><span class="header-section-number">4.5.1</span> Summary functions</a></li>
<li><a class="nav-link" href="#combine-functions-and-equations"><span class="header-section-number">4.5.2</span> Combine functions and equations</a></li>
</ul>
</li>
<li><a class="nav-link" href="#summarize-a-data-set-by-groups"><span class="header-section-number">4.6</span> Summarize a data set by groups</a></li>
<li><a class="nav-link" href="#quick-contingency-tables"><span class="header-section-number">4.7</span> Quick contingency tables</a></li>
<li>
<a class="nav-link" href="#visualize-a-categorical-and-numerical-variable"><span class="header-section-number">4.8</span> Visualize a categorical and numerical variable</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#multiple-histograms"><span class="header-section-number">4.8.1</span> Multiple histograms</a></li>
<li><a class="nav-link" href="#strip-plots"><span class="header-section-number">4.8.2</span> Strip plots</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#visualize-two-numerical-variables"><span class="header-section-number">4.9</span> Visualize two numerical variables</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#plotting-three-variables"><span class="header-section-number">4.9.1</span> Plotting three variables</a></li></ul>
</li>
<li>
<a class="nav-link" href="#assignment-2"><span class="header-section-number">4.10</span> Assignment</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#questions-1"><span class="header-section-number">4.10.1</span> Questions</a></li>
<li><a class="nav-link" href="#submission-2"><span class="header-section-number">4.10.2</span> Submission</a></li>
</ul>
</li>
<li><a class="nav-link" href="#submission-3"><span class="header-section-number">4.11</span> Submission</a></li>
<li><a class="nav-link" href="#further-reading-1"><span class="header-section-number">4.12</span> Further reading</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/BIOL275-MSUM/BIOL275-MSUM.github.io/blob/master/lab-4.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/BIOL275-MSUM/BIOL275-MSUM.github.io/edit/master/lab-4.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Quantitative Biology BIOL 275 at MSUM</strong>" was written by Chris Merkord. It was last built on 2022-02-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
